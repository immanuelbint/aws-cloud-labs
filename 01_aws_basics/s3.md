# Amazon S3

Amazon S3 is a core AWS service that provides infinite scalable storage that can be used widely across the web and AWS ecosystem. S3 stores data in a **buckets**, which stored in region specific and require unique global names with the specific name conventions. Objects in S3 identified by keys that represent full path include prefix that simulate folders. Object can be up to 5 TB and support multi part upload for large files.

## S3 Storage Classes

- **Amazon S3 Standard**: are default storage class that offers low latency and high throughput and it's designed for frequently accessed data. It can sustain two concurrent facility failure within AWS. Typically used for Big data analytics, gaming application, content distribution.

- **Amazon S3 Infrequent Access (Standard-IA)**: are intended for data that less frequently accessed but requires rapid access when needed. It offers lower cost than S3 standard but charges for retrieval. It's commonly used for disaster recovery and backups.

- **Amazon S3 One Zone-Infrequent Access (One Zone-IA)**: Stores data in a single Availability Zones (AZ) with high durability within that zone. However becareful if the AZ is destroyed the data will be lost.

### Glacier Storage Classes

Low cost object storage designed for archiving and backup. Pricing includes storage and retrieval costs.

- **Glacier Instant Retrieval**: provide milisecond retrieval times, suitable for data access about once a quarter, minimum storage duration is 90 days.

- **Glacier Flexible Retrieval**: formerly known as Amazon S3 Glacier, offers 3 retrieval options, expedited (1 to 5 minutes), standard (3 to 5 hours), bulk (5 to 12 hours but its free).

- **Glacier Deep Archive**: intended for long-term storage, offers 2 retrieval options, standard (12 hours), bulk (48 hours), minimum storage duration is 180 days, and offers the lowest cost among others glaciers classes.

### Amazon S3 Intelligent-Tiering

This class will automatically moves object between access tiers based on usage patterns, help optimize cost without performance impact. Incurs small monthly monitoring and auto tiering fee, no retrieval charges, access tiers include
- Frequent Access (default)
- Infrequent Access (objects not accessed for 30 days)
- Archive Instant Access (objecs not accessed over 90 days)
- Archive Access (optional, can be configure from 180 to 700+ days)
- Deep Archive Access (also optional, can be configure from 180 to 700+ days)

## S3 Bucket Policies

Use S3 bucket for policy
- grant public access to the bucket
- force object to be encrypted at upload
- grant access to another account (Cross Account)

Optional conditions
- public IP or Elastic IP (not on private IP)
- source VPC / source VPC endpoint, only works with VPC endpoint
- cloudfront origin identity
- MFA

## S3 Object Encryption

You can encrypt objects in S3 buckets using one of the 4 methods:

- **Server Side Encryption (SSE)**
  - **Server Side Encryption with Amazon S3 Managed Keys (SSE-S3)**, enabled by default, encrypt S3 object using keys handled, managed, and owned by AWS
  - **Server Side Encryption with KMS keys stored in AWS KMS (SSE-KMS)**, leveraged AWS Key Management Service (AWS KMS) to manage encryption keys
  - **Server Side Encryption with Customer Provided Keys (SSE-C)**
- **Client Side Encryption**

## S3 Object Lock

Adopt WORM (Write Once Read Many) model, block an object version deletion for specified amount of time 

- **Retention mode - Compliance**
  - object version can't be overwritten or deleted by any user, including the root user
  - objects retention modes can't be changed, and retention periods can't be shortened
- **Retention mode - Governance**
  - most user can't overwrite or delete an object version or alter its lock settings
  - some user have special permissions to change the retention or delete the object
- **Retention period**: protect the object for a fixed period, it can be extended
- **Legal Hold**
  - protect the object indefinitely, independent from retention period
  - can be freely placed and removed using the s3:PutObjectLegalHold IAM permission

## S3 Summary

- Buckets in Amazon S3 require global unique names and tied to specific regions.
- S3 security can be managed through IAM policies, bucket policies, and encryption.
- S3 also supports static website hosting by making the buckets public.
- Bucket versioning allows multiple version of files to prevent accidental deletion and enable rollback.
- S3 replication include same-region and cross-region replication, which require versioning to be enabled first.
- There are various S3 storage classes, including Standard, Infrequent Access, One Zone-Infrequent access, Intelligent Tiering, and Glacial archival classes.
- Snowball provides a physical device for data import and edge computing purposes.
- Storage Gateway offers hybrid solution to extend on-prem storage to Amazon S3
